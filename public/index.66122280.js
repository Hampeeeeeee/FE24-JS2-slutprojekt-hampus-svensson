let e;async function t(){try{let e=await fetch("https://fe24-js2-slutprojekt-hampus-default-rtdb.europe-west1.firebasedatabase.app/assignments.json");if(!e.ok)throw Error("Something went wrong fetching data");let t=await e.json(),n=Object.entries(t).map(([e,t])=>({id:e,...t}));return console.log(n),n}catch(e){return console.error("Error when fetching assignments:",e),[]}}async function n(e){try{e||(e=await t());let o=document.getElementById("todoContainer"),a=document.getElementById("inProgressContainer"),r=document.getElementById("doneContainer");o.innerHTML="",a.innerHTML="",r.innerHTML="",o&&e.forEach(e=>{if("new"===e.status){let t=document.createElement("div");t.classList.add("assignment"),t.setAttribute("data-timestamp",e.timestamp.toString());let n=e.timestamp,a=new Date(n).toLocaleString("sv-SE");t.innerHTML=`
                        <h2>To do</h2>
                        <h3>${e.title}</h3>
                        <p><i>${e.description}</i></p>
                        <h4><b>Qualification: ${e.category}</b></h4>
                        <h5>${a}</h5>
                        <button id="assignToBtn">Assign to</button>
                    `,o.appendChild(t);let r=t.querySelector("#assignToBtn");r&&r.addEventListener("click",async()=>{s(e.category,e.category,r,e.id)})}else if("in progress"===e.status){let t=document.createElement("div");t.classList.add("assignment"),t.setAttribute("data-timestamp",e.timestamp.toString());let o=e.timestamp,s=new Date(o).toLocaleString("sv-SE");t.innerHTML=`
                        <h2>In progress</h2>
                        <h3>${e.title}</h3>
                        <p><i>${e.description}</i></p>
                        <h4><b>Qualification: ${e.category}</b></h4>
                        <h5>${s}</h5>
                        <p>Assigned to: ${e.assigned}</p>
                        <button id="doneBtn">Done</button>
                    `,a.appendChild(t);let r=t.querySelector("#doneBtn");r&&r.addEventListener("click",async()=>{let t=`https://fe24-js2-slutprojekt-hampus-default-rtdb.europe-west1.firebasedatabase.app/assignments/${e.id}.json`,o={method:"PATCH",body:JSON.stringify({status:"done"}),headers:{"Content-Type":"application/json; charset=UTF-8"}};try{(await fetch(t,o)).ok?(console.log("Task status updated to done"),n()):console.error("Failed to update task status")}catch(e){console.error("Error while updating task status:",e)}})}else if("done"===e.status){let t=document.createElement("div");t.classList.add("assignment"),t.setAttribute("data-timestamp",e.timestamp.toString());let n=e.timestamp,o=new Date(n).toLocaleString("sv-SE");t.innerHTML=`
                        <h2>Done</h2>
                        <h3>${e.title}</h3>
                        <p><i>${e.description}</i></p>
                        <h4><b>Qualification: ${e.category}</b></h4>
                        <h5>${o}</h5>
                        <p>Assigned to: ${e.assigned}</p>
                        <button id="deleteBtn">Delete</button>
                    `,r.appendChild(t);let a=t.querySelector("#deleteBtn");a&&a.addEventListener("click",async()=>{let t=`https://fe24-js2-slutprojekt-hampus-default-rtdb.europe-west1.firebasedatabase.app/assignments/${e.id}.json`,n={method:"DELETE",body:JSON.stringify({status:"deleted"}),headers:{"Content-Type":"application/json; charset=UTF-8"}};try{(await fetch(t,n)).ok?console.log("Task status updated to deleted"):console.error("Failed to update task status")}catch(e){console.error("Error while updating task status:",e)}})}})}catch(e){console.error("Error displaying assignments:",e)}}async function o(e){e.preventDefault();let t=document.querySelector("#memberName").value.trim(),n=document.querySelector("#memberRole"),o=n.value;if(!t||!o){alert("Vänligen fyll i ett namn och välj en roll.");return}let a={method:"POST",body:JSON.stringify({name:t,role:o}),headers:{"Content-Type":"application/json; charset=UTF-8"}};try{let e=await fetch("https://fe24-js2-slutprojekt-hampus-default-rtdb.europe-west1.firebasedatabase.app//members.json",a);if(!e.ok)throw Error("Något gick fel när medlemmen skulle läggas till.");let s=await e.json();console.log("Medlem tillagd:",s);let r=document.createElement("div");r.classList.add("team-member"),r.textContent=`${t} - ${o}`,document.querySelector("#teamList")?.appendChild(r),document.querySelector("#memberName").value="",n.selectedIndex=-1}catch(e){console.error("Fel:",e),alert("Medlemmen kunde inte läggas till, försök igen!")}}async function a(){try{let e=await fetch("https://fe24-js2-slutprojekt-hampus-default-rtdb.europe-west1.firebasedatabase.app/members.json");if(!e.ok)throw Error("Failed to fetch members");let t=await e.json();return Object.values(t)}catch(e){return console.error("Error fetching members:",e),[]}}async function s(e,t,o,s){!function(e,t,o,a){if("Done"===o.textContent)return;let s=document.createElement("div");s.classList.add("modal"),s.innerHTML=`
        <div class="modal-content">
            <h3>Assign task for category: ${t}</h3>
            <ul>
                ${e.map(e=>`
                    <li>
                        <button class="assign-btn">${e.name} (${e.role})</button>
                    </li>
                `).join("")}
            </ul>
            <button class="close-modal">Close</button>
        </div>
    `,document.body.appendChild(s);let r=o.getBoundingClientRect();s.style.position="absolute",s.style.left=`${r.right+window.scrollX}px`,s.style.top=`${r.top+window.scrollY}px`,s.querySelectorAll(".assign-btn").forEach((t,r)=>{t.addEventListener("click",async()=>{let t=e[r],l=`https://fe24-js2-slutprojekt-hampus-default-rtdb.europe-west1.firebasedatabase.app/assignments/${a}.json`,i={method:"PATCH",body:JSON.stringify({status:"in progress",assigned:t.name}),headers:{"Content-Type":"application/json; charset=UTF-8"}};try{(await fetch(l,i)).ok?(console.log("Task status updated to in progress"),n()):console.error("Failed to update task status")}catch(e){console.error("Error while updating task status:",e)}let d=o.closest(".assignment");if(d){let e=document.getElementById("inProgressContainer");if(e){e.appendChild(d);let t=d.querySelector("#assignToBtn");t&&t.addEventListener("click",()=>{let e=document.getElementById("doneContainer");e&&e.appendChild(d),t.addEventListener("click",()=>{e&&e.removeChild(d),s.parentElement&&s.parentElement.removeChild(s)})})}}s.parentElement&&s.parentElement.removeChild(s)});let l=s.querySelector(".close-modal");l?.addEventListener("click",()=>{s.parentElement&&s.parentElement.removeChild(s)})})}((await a()).filter(t=>t.role===e),t,o,s)}async function r(e){e.preventDefault();let t=document.querySelector("#assignmentName").value.trim(),n=document.querySelector("#assignmentDescription").value.trim(),o=document.querySelector("#assignmentRole").value;if(!t||!o){alert("Please provide both title and role.");return}let a={title:t,description:n,category:o,status:"new",assigned:void 0,timestamp:Date.now()};console.log("New Assignment to add:",a);let s={method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json; charset=UTF-8"}};try{let e=await fetch("https://fe24-js2-slutprojekt-hampus-default-rtdb.europe-west1.firebasedatabase.app/assignments.json",s);if(!e.ok)throw Error("Something went wrong when adding an assignment.");let t=await e.json();console.log("Assignment added:",t),document.querySelector("#assignmentName").value="",document.querySelector("#assignmentDescription").value="",document.querySelector("#assignmentRole").selectedIndex=0}catch(e){console.error("Error:",e),alert("Could not add assignment, try again!")}}function l(e){let t=document.querySelector("#inProgressContainer");if(!t)return;let n=Array.from(t.querySelectorAll(".assignment"));n.forEach(e=>{let t=parseInt(e.getAttribute("data-timestamp")||"0");console.log(`Element ID: ${e.id}, Timestamp: ${t}`)}),n.sort((t,n)=>{let o=parseInt(t.getAttribute("data-timestamp")||"0"),a=parseInt(n.getAttribute("data-timestamp")||"0");return console.log(`Comparing ${o} with ${a}`),"newestToOldest"===e?a-o:o-a}).forEach(e=>t.appendChild(e))}function i(e){let t=document.querySelector("#inProgressContainer");t&&Array.from(t.querySelectorAll(".assignment")).sort((t,n)=>{let o=t.querySelector("h3")?.textContent?.toLowerCase()||"",a=n.querySelector("h3")?.textContent?.toLowerCase()||"";return"titleAsc"===e?o.localeCompare(a):a.localeCompare(o)}).forEach(e=>t.appendChild(e))}const d=(e,t)=>e.filter(e=>e.assigned===t),c=(e,t)=>e.filter(e=>e.category===t);async function m(){let e=document.querySelector("#memberFilter");try{(await a()).forEach(t=>{let n=document.createElement("option");n.value=t.name,n.textContent=t.name,e.appendChild(n)})}catch(e){console.error("Error populating member filter:",e)}}t().then(t=>e=t),document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector("#addMemberForm");e&&e.addEventListener("submit",o)}),document.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector("#addAssignmentForm");e&&e.addEventListener("submit",r)}),document.querySelector("#timestampSorting")?.addEventListener("change",e=>{let t=e.target.value;"asc"===t?l("oldestToNewest"):"desc"===t&&l("newestToOldest")}),document.querySelector("#titleSorting")?.addEventListener("change",e=>{let t=e.target.value;"titleAsc"===t?i("titleAsc"):"titleDesc"===t&&i("titleDesc")}),document.addEventListener("DOMContentLoaded",m),n();const u=document.querySelector("#memberFilter");console.log(u),u?.addEventListener("change",()=>{console.log(u.value);let t=d(e,u.value);n(t),console.log(t)});const p=document.querySelector("#categoryFilter");console.log(p),p?.addEventListener("change",()=>{console.log(p.value);let t=c(e,p.value);n(t),console.log(t)});
//# sourceMappingURL=index.66122280.js.map
